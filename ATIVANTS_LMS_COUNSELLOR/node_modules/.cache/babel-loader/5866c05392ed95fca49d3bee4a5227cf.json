{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\Activants46\\\\Desktop\\\\githubLMS\\\\counsellorserver\\\\ATIVANTS_LMS_COUNSELLOR\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Activants46\\\\Desktop\\\\githubLMS\\\\counsellorserver\\\\ATIVANTS_LMS_COUNSELLOR\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\Activants46\\\\Desktop\\\\githubLMS\\\\counsellorserver\\\\ATIVANTS_LMS_COUNSELLOR\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Activants46\\\\Desktop\\\\githubLMS\\\\counsellorserver\\\\ATIVANTS_LMS_COUNSELLOR\\\\src\\\\MainComponents\\\\DesktopComponent.js\";\n\nimport GetWidthOfComponent from './GetWidthOfComponent';\nimport React, { useState, useEffect } from 'react';\nimport _NavigationItems from '../SecondaryComponents/Desktop/_NavigationItems';\nimport _Promos from '../SecondaryComponents/Desktop/_Promos';\nimport axios from 'axios';\nimport { Responsive } from 'semantic-ui-react';\nimport UserDashboard from '../SecondaryComponents/Desktop/UserDashboard/UserDashboard';\nimport CounsellorDashboard from '../SecondaryComponents/Desktop/UserDashboard/CounsellorDashboard';\nimport Cookies from 'js-cookie';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { BrowserRouter as Router, Switch, Route, Redirect } from \"react-router-dom\";\nimport { baseURLAPI, baseURL } from \"../Global\";\nvar Authorize = React.createContext();\n\nvar DesktopComponent = function DesktopComponent(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isAuthenticated = _useState2[0],\n      setIsAuthenticated = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isCounsellor = _useState4[0],\n      setIsCounsellor = _useState4[1];\n\n  var setAuth = function setAuth(boolean) {\n    setIsAuthenticated(boolean);\n  };\n\n  var setCount = function setCount(boolean) {\n    setIsCounsellor(boolean);\n  };\n\n  var checkAuthenticated = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var queryString, urlParams, id, response, res, parseRes;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n\n              if (!localStorage.jwtToken) {\n                _context.next = 24;\n                break;\n              }\n\n              console.log(\"-------------------------[hiojhl         \");\n              queryString = window.location.search;\n              urlParams = new URLSearchParams(queryString);\n              id = urlParams.get('id');\n\n              if (!(id && localStorage.userID)) {\n                _context.next = 12;\n                break;\n              }\n\n              _context.next = 9;\n              return axios({\n                url: \"http://localhost:5000/request/userID?userID=\" + localStorage.userID + \"&requestID=\" + id,\n                method: \"GET\"\n              });\n\n            case 9:\n              response = _context.sent;\n              console.log(response);\n\n              if (response.status == 200) {\n                window.close();\n              }\n\n            case 12:\n              _context.next = 14;\n              return fetch(\"http://localhost:5000/auth/verify/\", {\n                method: \"GET\",\n                headers: {\n                  jwtToken: localStorage.jwtToken\n                }\n              });\n\n            case 14:\n              res = _context.sent;\n              _context.next = 17;\n              return res.json();\n\n            case 17:\n              parseRes = _context.sent;\n              console.log('parseRes');\n              console.log(parseRes);\n\n              if (parseRes.message) {\n                localStorage.setItem(\"userID\", parseRes.userID);\n                setIsAuthenticated(true);\n              } else {\n                localStorage.clear();\n                setIsAuthenticated(false);\n                toast.error(\"An error occured, Try again\", {\n                  position: \"top-right\",\n                  autoClose: 3000,\n                  hideProgressBar: true,\n                  closeOnClick: true,\n                  pauseOnHover: false,\n                  draggable: true,\n                  progress: ''\n                });\n              }\n\n              fetch(\"http://localhost:5000/user/\" + localStorage.userID, {\n                method: \"GET\"\n              }).then(function (response) {\n                if (response.status === 200) return response.json();\n                throw new Error(\"failed to authenticate user\");\n              }).then(function (parseResponse) {\n                console.log([\"------------------------\", parseResponse]);\n                localStorage.setItem(\"isCounsellor\", parseResponse.user.IS_COUNSELLOR);\n                localStorage.setItem(\"isCounsellor\", parseResponse.user.IS_COUNSELLOR);\n              });\n              _context.next = 25;\n              break;\n\n            case 24:\n              fetch(\"http://localhost:5000/socialauth/login/success\", {\n                method: \"GET\",\n                credentials: \"include\",\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  \"Access-Control-Allow-Credentials\": false\n                }\n              }).then(function (response) {\n                if (response.status === 200) return response.json();\n                throw new Error(\"failed to authenticate user\");\n              }).then(function (responseJson) {\n                console.log(\"responseJson is -====\", responseJson);\n                localStorage.setItem(\"isCounsellor\", responseJson.isCounsellor);\n\n                try {\n                  if (parseInt(localStorage.isCounsellor) == 3) {\n                    fetch(\"http://localhost:5000/user/\" + responseJson.userID, {\n                      method: \"GET\"\n                    }).then(function (response) {\n                      if (response.status === 200) return response.json();\n                      throw new Error(\"failed to authenticate user\");\n                    }).then(function (parseResponse) {\n                      console.log([\"------------------------\", parseResponse.IS_COUNSELLOR]);\n                      console.log([\"------------------------\", parseResponse.user.IS_COUNSELLOR]);\n                      console.log([\"------------------------\", parseResponse]);\n                      localStorage.setItem(\"userID\", parseResponse.user.ID_USER_UUID);\n                      localStorage.setItem(\"isCounsellor\", parseResponse.user.IS_COUNSELLOR);\n\n                      if (parseInt(localStorage.isCounsellor) == 1) {\n                        console.log([\"------------SET------------\"]);\n                        setIsCounsellor(true);\n                      } else {\n                        console.log([\"------------SET------------\"]);\n                        setIsCounsellor(false);\n                      }\n                    });\n                  }\n                } catch (err) {\n                  console.log(err);\n                }\n\n                localStorage.setItem(\"jwtToken\", responseJson.jwtToken);\n                localStorage.setItem(\"userID\", responseJson.userID);\n                var res = fetch(\"http://localhost:5000/auth/verify/\", {\n                  method: \"GET\",\n                  headers: {\n                    jwtToken: localStorage.jwtToken\n                  }\n                });\n                setIsAuthenticated(true);\n              }).catch(function (error) {\n                console.log(\"error is -====\", error);\n              });\n\n            case 25:\n              _context.next = 31;\n              break;\n\n            case 27:\n              _context.prev = 27;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(\"---------------------------------------------------------------------\", _context.t0);\n              console.error(_context.t0.message);\n\n            case 31:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 27]]);\n    }));\n\n    return function checkAuthenticated() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    checkAuthenticated();\n    console.log([\"------------SET--  sdfasdff ----------\", localStorage.userID, localStorage.isCounsellor]);\n    fetch(\"http://localhost:5000/user/\" + localStorage.userID, {\n      method: \"GET\"\n    }).then(function (response) {\n      if (response.status === 200) return response.json();\n      throw new Error(\"failed to authenticate user\");\n    }).then(function (parseResponse) {\n      console.log([\"------------------------\", parseResponse]);\n\n      if (parseResponse) {\n        localStorage.setItem(\"isCounsellor\", parseResponse.user.IS_COUNSELLOR);\n        localStorage.setItem(\"userID\", parseResponse.user.ID_USER_UUID);\n      }\n\n      console.log([\"------------SET  C------------\", localStorage.isCounsellor]);\n\n      if (parseInt(localStorage.isCounsellor) == 1) {\n        console.log([\"------------SET------------\"]);\n        setIsCounsellor(true);\n      } else {\n        console.log([\"------------SET------------\"]);\n        setIsCounsellor(false);\n      }\n    });\n  }, []);\n  return /*#__PURE__*/React.createElement(Responsive, {\n    getWidth: GetWidthOfComponent,\n    minWidth: Responsive.onlyTablet.minWidth,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Router, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Authorize.Provider, {\n    value: setAuth,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/dashboard\",\n    render: function render(props) {\n      return localStorage.isCounsellor ? parseInt(localStorage.isCounsellor) == 1 ? /*#__PURE__*/React.createElement(\"div\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(CounsellorDashboard, Object.assign({}, props, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 28\n        }\n      }))) : /*#__PURE__*/React.createElement(\"div\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 27\n        }\n      }, \" \", /*#__PURE__*/React.createElement(UserDashboard, Object.assign({}, props, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 33\n        }\n      }))) : /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 23\n        }\n      });\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/\",\n    render: function render(props) {\n      return !isAuthenticated ? /*#__PURE__*/React.createElement(_NavigationItems, Object.assign({}, props, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 23\n        }\n      })) : /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/dashboard/\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 23\n        }\n      });\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 15\n    }\n  }))))));\n};\n\nexport default DesktopComponent;\nexport { Authorize };","map":{"version":3,"sources":["C:/Users/Activants46/Desktop/githubLMS/counsellorserver/ATIVANTS_LMS_COUNSELLOR/src/MainComponents/DesktopComponent.js"],"names":["GetWidthOfComponent","React","useState","useEffect","_NavigationItems","_Promos","axios","Responsive","UserDashboard","CounsellorDashboard","Cookies","ToastContainer","toast","BrowserRouter","Router","Switch","Route","Redirect","baseURLAPI","baseURL","Authorize","createContext","DesktopComponent","children","isAuthenticated","setIsAuthenticated","isCounsellor","setIsCounsellor","setAuth","boolean","setCount","checkAuthenticated","localStorage","jwtToken","console","log","queryString","window","location","search","urlParams","URLSearchParams","id","get","userID","url","method","response","status","close","fetch","headers","res","json","parseRes","message","setItem","clear","error","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","then","Error","parseResponse","user","IS_COUNSELLOR","credentials","Accept","responseJson","parseInt","ID_USER_UUID","err","catch","onlyTablet","minWidth","props"],"mappings":"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","sourcesContent":["import GetWidthOfComponent from './GetWidthOfComponent'\r\nimport React, { useState, useEffect } from 'react'\r\nimport _NavigationItems from '../SecondaryComponents/Desktop/_NavigationItems'\r\nimport _Promos from '../SecondaryComponents/Desktop/_Promos'\r\nimport axios from 'axios'\r\nimport { Responsive } from 'semantic-ui-react'\r\nimport UserDashboard from '../SecondaryComponents/Desktop/UserDashboard/UserDashboard';\r\nimport CounsellorDashboard from '../SecondaryComponents/Desktop/UserDashboard/CounsellorDashboard'; \r\nimport Cookies from 'js-cookie';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport {  BrowserRouter as Router,  Switch,  Route,  Redirect} from \"react-router-dom\";\r\n\r\nimport {baseURLAPI ,baseURL }from \"../Global\";\r\nconst Authorize = React.createContext();\r\n  \r\nconst DesktopComponent = ({ children }) => {\r\n\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false); \r\n  const [isCounsellor, setIsCounsellor] = useState(0); \r\n  const setAuth = (boolean) => {\r\n\r\n    setIsAuthenticated(boolean);\r\n\r\n  } \r\n\r\n  const setCount = (boolean) => {\r\n\r\n    setIsCounsellor(boolean);\r\n\r\n  } \r\n\r\n  const checkAuthenticated = async () => {\r\n    try {\r\n \r\n\r\n    if (localStorage.jwtToken) {\r\n\r\n      console.log(\"-------------------------[hiojhl         \")\r\n        const queryString = window.location.search;\r\n        const urlParams = new URLSearchParams(queryString);        \r\n        const id = urlParams.get('id');\r\n        \r\n\r\n          if (id && localStorage.userID) {\r\n            const response = await axios ({\r\n              url: \"http://localhost:5000/request/userID?userID=\"+localStorage.userID+\"&requestID=\"+id     ,\r\n              method: \"GET\"\r\n            })\r\n            \r\n            console.log(response)\r\n            \r\n            if (response.status == 200)\r\n            {\r\n              window.close();\r\n                          \r\n            }\r\n          }\r\n\r\n     \r\n        const res = await fetch(\"http://localhost:5000/auth/verify/\", {\r\n          \r\n          method: \"GET\",\r\n          headers: { jwtToken: localStorage.jwtToken }\r\n        });\r\n        const parseRes = await res.json();\r\n        console.log('parseRes'); \r\n        console.log(parseRes);\r\n\r\n        if (parseRes.message){\r\n\r\n          localStorage.setItem(\"userID\", parseRes.userID         ); \r\n          setIsAuthenticated(true) \r\n\r\n        }else {\r\n          localStorage.clear();\r\n\r\n          setIsAuthenticated(false);\r\n          toast.error(\"An error occured, Try again\", {\r\n            position: \"top-right\",\r\n            autoClose: 3000,\r\n            hideProgressBar: true,\r\n            closeOnClick: true,\r\n            pauseOnHover: false,\r\n            draggable: true,\r\n            progress: '',\r\n        });\r\n        }\r\n \r\n        \r\n          fetch(\"http://localhost:5000/user/\"+localStorage.userID, {\r\n            method: \"GET\",\r\n            \r\n          })\r\n          .then(response => {\r\n            if (response.status === 200) return response.json();\r\n            throw new Error(\"failed to authenticate user\");\r\n          })\r\n          .then(parseResponse => {\r\n          \r\n            console.log([\"------------------------\",parseResponse]); \r\n             localStorage.setItem(\"isCounsellor\", parseResponse.user.IS_COUNSELLOR);\r\n              localStorage.setItem(\"isCounsellor\", parseResponse.user.IS_COUNSELLOR);\r\n\r\n\r\n\r\n          });\r\n  \r\n          \r\n      }\r\n      else {             \r\n\r\n        fetch(\"http://localhost:5000/socialauth/login/success\", {\r\n          method: \"GET\",\r\n          credentials: \"include\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\",\r\n            \"Access-Control-Allow-Credentials\": false,\r\n          }\r\n        })\r\n          .then(response => {\r\n            if (response.status === 200) return response.json();\r\n            throw new Error(\"failed to authenticate user\");\r\n          })\r\n          .then(responseJson => {\r\n            console.log(\"responseJson is -====\", responseJson);            \r\n            localStorage.setItem(\"isCounsellor\", responseJson.isCounsellor);\r\n\r\n\r\ntry { if (parseInt(localStorage.isCounsellor) == 3 ){    \r\n              fetch(\"http://localhost:5000/user/\"+responseJson.userID, {\r\n                method: \"GET\",\r\n                \r\n              })\r\n              .then(response => {\r\n                if (response.status === 200) return response.json();\r\n                throw new Error(\"failed to authenticate user\");\r\n              })\r\n              .then(parseResponse => {\r\n                  console.log([\"------------------------\",parseResponse.IS_COUNSELLOR]); \r\n                  console.log([\"------------------------\",parseResponse.user.IS_COUNSELLOR]); \r\n                  \r\n                console.log([\"------------------------\",parseResponse]); \r\n\r\n                  localStorage.setItem(\"userID\", parseResponse.user.ID_USER_UUID);\r\n                 localStorage.setItem(\"isCounsellor\", parseResponse.user.IS_COUNSELLOR);\r\n                 if (parseInt(localStorage.isCounsellor)    == 1){\r\n                  console.log([\"------------SET------------\" ]); \r\n                  setIsCounsellor(true);\r\n            \r\n                }else {\r\n                   \r\n                  console.log([\"------------SET------------\" ]); \r\n                  setIsCounsellor(false);\r\n                } \r\n\r\n              });\r\n\r\n            }\r\n }catch(err){console.log(err);}\r\n           \r\n \r\n            localStorage.setItem(\"jwtToken\", responseJson.jwtToken); \r\n            localStorage.setItem(\"userID\", responseJson.userID); \r\n\r\n            const res = fetch(\"http://localhost:5000/auth/verify/\", {\r\n              method: \"GET\",\r\n              headers: { jwtToken: localStorage.jwtToken }\r\n            });\r\n              setIsAuthenticated(true)  \r\n         \r\n          })           \r\n          .catch(error => {\r\n            console.log(\"error is -====\", error);\r\n          });\r\n        }\r\n         \r\n    \r\n\r\n    } catch (err) {\r\n      console.log(\"---------------------------------------------------------------------\", err);\r\n      console.error(err.message);\r\n    }\r\n  };\r\n   \r\n  useEffect(() => {\r\n     checkAuthenticated();\r\n     \r\n    \r\n       \r\n      console.log([\"------------SET--  sdfasdff ----------\" ,     localStorage.userID,localStorage.isCounsellor             ]); \r\n     \r\n\r\n        fetch(\"http://localhost:5000/user/\"+localStorage.userID, {\r\n        method: \"GET\",\r\n        \r\n      })\r\n      .then(response => {\r\n        if (response.status === 200) return response.json();\r\n        throw new Error(\"failed to authenticate user\");\r\n      })\r\n      .then(parseResponse => {\r\n     \r\n        console.log([\"------------------------\",parseResponse]); \r\n        if(parseResponse){ \r\n         localStorage.setItem(\"isCounsellor\", parseResponse.user.IS_COUNSELLOR); \r\n         localStorage.setItem(\"userID\", parseResponse.user.ID_USER_UUID);\r\n        }\r\n         console.log([\"------------SET  C------------\",localStorage.isCounsellor ]); \r\n\r\n         if (parseInt(localStorage.isCounsellor)    == 1){\r\n           console.log([\"------------SET------------\" ]); \r\n           setIsCounsellor(true);\r\n     \r\n         }else {\r\n            \r\n           console.log([\"------------SET------------\" ]); \r\n           setIsCounsellor(false);\r\n         } \r\n      });\r\n\r\n     \r\n\r\n\r\n\r\n  }, []);\r\n\r\n \r\n\r\n\r\n  return (\r\n    <Responsive getWidth={GetWidthOfComponent} minWidth={Responsive.onlyTablet.minWidth}>\r\n      <Router>\r\n        <div className=\"container\">\r\n          <Authorize.Provider value={setAuth}>\r\n            <Switch>\r\n              <Route exact path=\"/dashboard\" render=\r\n                {\r\n                  props => localStorage.isCounsellor ?\r\n                    (\r\n                      parseInt(localStorage.isCounsellor)  ==1  ? (\r\n                      <div><CounsellorDashboard {...props} />\r\n                       </div>\r\n                        ) :                        \r\n                        (\r\n                        \r\n                          <div> <UserDashboard {...props} />\r\n                           </div>\r\n                       \r\n                          \r\n                          )                       \r\n                    ) :\r\n                    (\r\n                      <Redirect to=\"/\" />\r\n                    )\r\n                }>\r\n              </Route>\r\n              <Route exact path=\"/\" render=\r\n                {\r\n                  props => !isAuthenticated ?\r\n                    (\r\n                      <_NavigationItems {...props} />\r\n                    ) :\r\n                    (\r\n                      <Redirect to=\"/dashboard/\" />\r\n                    )\r\n                }>\r\n              </Route>\r\n            </Switch>\r\n          </Authorize.Provider>\r\n        </div>\r\n      </Router>\r\n    </Responsive>\r\n  )\r\n}\r\n\r\nexport default DesktopComponent;\r\nexport {\r\n  Authorize\r\n}"]},"metadata":{},"sourceType":"module"}